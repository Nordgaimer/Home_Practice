package JdbcUtils;

import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

//import org.apache.xml.serialize.OutputFormat;
//import org.apache.xml.serialize.XMLSerializer;
import org.w3c.dom.Document;
import org.w3c.dom.Element;

public class XMLBuilder {
	 /*
     * Create xml string - fastest, but may have encoding issues
     */
    public static String toXML(ResultSet rs,String XMLDataName) throws SQLException
    {
        ResultSetMetaData rsmd = rs.getMetaData();
        int colCount = rsmd.getColumnCount();
        StringBuffer xml = new StringBuffer();
        xml.append(XMLDataName+"\n");

        while (rs.next())
        {
            //xml.append("");

            for (int i = 1; i <= colCount; i++)
            {
                String addDescription = XMLDescriptionMaker.addDescr(rsmd.getColumnName(i));
            	String columnName = rsmd.getColumnName(i);
                Object value = rs.getObject(i);
                xml.append("<" + columnName + addDescription + ">");

                if (value != null)
                {
                    xml.append(value.toString().trim());
                }
                xml.append("</" + columnName + ">" +"\n");
            }
           // xml.append("</Row>");
        }

        xml.append("</Table"+XMLDataName+">");

        return xml.toString();
    }

 

}